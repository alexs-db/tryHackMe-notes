Now that we have a basic understanding of JavaScript, let's dive into Prototype Pollution using the same social network example.

![image of character holding the laptop](image-url)

Prototype pollution is a vulnerability that arises when an attacker manipulates an object's prototype, impacting all instances of that object. In JavaScript, where prototypes facilitate inheritance, an attacker can exploit this to modify shared properties or inject malicious behavior across objects.

Prototype pollution, on its own, might not always present a directly exploitable threat. However, its true potential for harm becomes notably pronounced when it joins with other types of vulnerabilities, such as XSS and CSRF.

### A Common Example

Let's assume we have a basic prototype for `Person` with an `introduce` method. The attacker aims to manipulate the behavior of the `introduce` method across all instances by altering the prototype.

```javascript
// Base Prototype for Persons
let personPrototype = {
    introduce: function() {
        return `Hi, I'm ${this.name}.`;
    }
};

// Person Constructor Function
function Person(name) {
    let person = Object.create(personPrototype);
    person.name = name;
    return person;
}

// Creating an instance
let ben = Person('Ben');
```

Please copy the above code, paste it into the console, and hit enter. When we create a new object, `ben`, and call the `introduce` method, it displays `Hi, I'm Ben`, as shown in the following figure.

![image of console](image-url)

What if an attacker injects malicious content into the `introduce` method for all instances using the `__proto__` property? In JavaScript, the `__proto__` property is a common way to access the prototype of an object, essentially pointing to the object from which it inherits properties and methods. Let's see, somehow, the attacker executes the following code using any attack vector like XSS, CSRF, etc.

```javascript
// Attacker's Payload
ben.__proto__.introduce = function() {
    console.log("You've been hacked, I'm Bob");
}
console.log(ben.introduce());
```

We will discuss in detail what exactly is happening in the background:

1. **Prototype Definition**: The `Person` prototype (`personPrototype`) is initially defined with a harmless `introduce` method, introducing the person.
2. **Object Instantiation**: An instance of `Person` is created with the name 'Ben' (`let ben = Person('Ben');`).
3. **Prototype Pollution Attack**: The attacker injects a malicious payload into the prototype's `introduce` method, changing its behavior to display a harmful message.
4. **Impact on Existing Instances**: As a result, even the existing instance (`ben`) is affected, and calling `ben.introduce()` now outputs the attacker's injected message.

This example shows how an attacker can alter the behavior of shared methods across objects, potentially causing security risks. Preventing prototype pollution involves carefully validating input data and avoiding directly modifying prototypes with untrusted content.